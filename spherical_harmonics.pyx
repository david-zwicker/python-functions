"""
Cython code evaluating axisymmetric spherical harmonics (order m=0)
for low integer degree (l<=30).

Compile this code using

cython -a spherical_harmonics.pyx
gcc -shared -pthread -fPIC -fwrapv -O2 -Wall -fno-strict-aliasing \
    -I/usr/include/python2.5 -o -lm spherical_harmonics.so spherical_harmonics.c

Here, the path to the python libraries might have to be changed.

This code and information is provided 'as is' without warranty of any kind,
either express or implied, including, but not limited to, the implied
warranties of non-infringement, merchantability or fitness for a particular
purpose.
"""

cdef extern from 'math.h':
  double cos(double x)

cpdef double spherical_harmonic_sym(int n, double theta):
  cdef double x = cos(theta)
  cdef double x2 = x*x
  if n == 0:
    return 0.28209479177387814
  elif n == 1:
    return 0.4886025119029199*x
  elif n == 2:
    return -0.31539156525252005 + 0.9461746957575601*x2
  elif n == 3:
    return x*(-1.1195289977703462 + 1.865881662950577*x2)
  elif n == 4:
    return 0.31735664074561293 + x2*(-3.1735664074561294 + 3.7024941420321507*x2)
  elif n == 5:
    return x*(1.754254836801354 + x2*(-8.186522571739651 + 7.367870314565687*x2))
  elif n == 6:
    return -0.3178460113381421 + x2*(6.674766238100984 + x2*(-20.024298714302954 + 14.684485723822165*x2))
  elif n == 7:
    return x*(-2.3899496919201733 + x2*(21.50954722728156 + x2*(-47.32100390001943 + 29.293954795250123*x2)))
  elif n == 8:
    return 0.31803696720477487 + x2*(-11.449330819371895 + x2*(62.97131950654543 + x2*(-109.15028714467873 + 58.47336811322075*x2)))
  elif n == 9:
    return x*(3.0260245882817762 + x2*(-44.381693961466055 + x2*(173.08860644971762 + x2*(-247.26943778531086 + 116.76612339861902*x2))))
  elif n == 10:
    return -0.31813049373736707 + x2*(17.49717715555519 + x2*(-151.64220201481163 + x2*(454.9266060444349 + x2*(-552.4108787682424 + 233.2401488132579*x2))))
  elif n == 11:
    return x*(-3.662285987505434 + x2*(79.34952972928441 + x2*(-476.09717837570645 + x2*(1156.2360046267156 + x2*(-1220.4713382170887 + 465.99814731925204*x2)))))
  elif n == 12:
    return 0.31818309033088793 + x2*(-24.818281045809258 + x2*(310.2285130726157 + x2*(-1406.3692592625246 + x2*(2862.9659920701392 + x2*(-2672.1015925987967 + 931.1869186329141*x2)))))
  elif n == 13:
    return x*(4.298652372786529 + x2*(-128.95957118359587 + x2*(1096.156355060565 + x2*(-3967.0420468858542 + x2*(6942.323582050245 + x2*(-5806.306995896568 + 1860.9958320181308*x2))))))
  elif n == 14:
    return -0.31821555633682225 + x2*(33.41263341536634 + x2*(-568.0147680612278 + x2*(3597.426864387776 + x2*(-10792.280593163327 + x2*(16548.163576183768 + x2*(-12536.487557714976 + 3719.617187453894*x2))))))
  elif n == 15:
    return x*(-4.935083598341308 + x2*(195.75831606753854 + x2*(-2231.644803169939 + x2*(11158.224015849697 + x2*(-28515.461373838112 + x2*(38884.72005523379 + x2*(-26920.190807469546 + 7435.100318253494*x2)))))))
  elif n == 16:
    return 0.3182369871585684 + x2*(-43.2802302535653 + x2*(959.3784372873642 + x2*(-8058.778873213859 + x2*(33098.556086414064 + x2*(-73552.34685869791 + x2*(90268.7893265838 + x2*(-57533.953636723745 + 14862.938022820303*x2)))))))
  elif n == 17:
    return x*(5.5715576399302265 + x2*(-282.2922537564648 + x2*(4149.6961302200325 + x2*(-27269.431712874502 + x2*(94685.52678081424 + x2*(-185927.9434968716 + x2*(207381.16774651062 + x2*(-122453.64190746342 + 29713.016051075683*x2))))))))
  elif n == 18:
    return -0.3182518688246037 + x2*(54.42106956900724 + x2*(-1523.7899479322025 + x2*(16355.345441138974 + x2*(-87617.92200610165 + x2*(262853.766018305 + x2*(-461985.40694126324 + x2*(472138.93236854376 + x2*(-259676.41280269905 + 59403.100967937695*x2))))))))
  elif n == 19:
    return x*(-6.2080614201252455 + x2*(391.10786946789045 + x2*(-7196.384798209184 + x2*(59969.87331840987 + x2*(-269864.4299328444 + x2*(711460.7698229534 + x2*(-1.13104019818008e6 + x2*(1.0664093297126468e6 + x2*(-548887.1549991564 + 118765.05692964203*x2)))))))))
  elif n == 20:
    return 0.31826262039531755 + x2*(-66.83515028301669 + x2*(2305.8126847640756 + x2*(-30744.169130187678 + x2*(207523.1416287668 + x2*(-802422.8142978983 + x2*(1.8844778214571855e6 + x2*(-2.733528268487346e6 + x2*(2.3918372349264277e6 + x2*(-1.1568363097029782e6 + 237455.8740969271*x2)))))))))
  elif n == 21:
    return x*(6.844586689123469 + x2*(-524.7516461661327 + x2*(11806.912038737984 + x2*(-121442.52382701928 + x2*(684800.8982468031 + x2*(-2.3158721286164615e6 + x2*(4.898960272073284e6 + x2*(-6.531947029431045e6 + x2*(5.331221472550338e6 + x2*(-2.431785233093137e6 + 474777.11693723145*x2))))))))))
  elif n == 22:
    return -0.318270639408897 + x2*(80.52247177045093 + x2*(-3355.1029904354555 + x2*(54352.66844505438 + x2*(-450350.6814018792 + x2*(2.1716910636490616e6 + x2*(-6.515073190947185e6 + x2*(1.2528986905667664e7 + x2*(-1.5452417183656786e7 + x2*(1.1816554316914013e7 + x2*(-5.099776073615521e6 + 949308.9660842745*x2))))))))))
  elif n == 23:
    return x*(-7.48112798737384 + x2*(685.7700655092686 + x2*(-18515.791768750252 + x2*(230124.84055446743 + x2*(-1.5853044571529978e6 + x2*(6.658278720042591e6 + x2*(-1.7926135015499283e7 + x2*(3.1584142646355882e7 + x2*(-3.62288695061141e7 + x2*(2.6059362276327685e7 + x2*(-1.0671929313162766e7 + 1.8981692454242075e6*x2)))))))))))
  elif n == 24:
    return 0.3182767788296093 + x2*(-95.4830336488828 + x2*(4726.410165619698 + x2*(-91377.26320198084 + x2*(910509.1583340233 + x2*(-5.341653728892936e6 + x2*(1.9828866114829842e7 + x2*(-4.8373717335079394e7 + x2*(7.860729066950402e7 + x2*(-8.42587952274422e7 + x2*(5.720728728600024e7 + x2*(-2.228855348805204e7 + 3.795514543255239e6*x2)))))))))))
  elif n == 25:
    return x*(8.117681558852917 + x2*(-876.709608356115 + x2*(27967.03650656007 + x2*(-412846.7293825534 + x2*(3.4059855174060655e6 + x2*(-1.7339562634067245e7 + x2*(5.757624002850533e7 + x2*(-1.283127634920976e8 + x2*(1.9341262144029418e8 + x2*(-1.945436894019333e8 + x2*(1.2506380032981429e8 + x2*(-4.6466392217401356e7 + 7.589510728842221e6*x2))))))))))))
  elif n == 26:
    return -0.3182815831161795 + x2*(111.71683567377902 + x2*(-6479.576469079183 + x2*(147302.37173040007 + x2*(-1.7360636668225725e6 + x2*(1.2152445667758007e7 + x2*(-5.450187754024803e7 + x2*(1.6350563262074408e8 + x2*(-3.351865468725254e8 + x2*(4.7101377501694745e8 + x2*(-4.462235763318449e8 + x2*(2.723702349038534e8 + x2*(-9.671117036441171e7 + 1.5176214426415378e7*x2))))))))))))
  elif n == 27:
    return x*(-8.754244735180412 + x2*(1100.1167550543385 + x2*(-40924.34328802139 + x2*(707406.5054072269 + x2*(-6.877563247014706e6 + x2*(4.164051929556176e7 + x2*(-1.6656207718224704e8 + x2*(4.5526967763147527e8 + x2*(-8.636733590361811e8 + x2*(1.1364123145212908e9 + x2*(-1.0173595958571557e9 + x2*(5.911140734822209e8 + x2*(-2.009787849839551e8 + 3.034722394344621e7*x2)))))))))))))
  elif n == 28:
    return 0.31828541301207125 + x2*(-129.22387768290093 + x2*(8679.537117701511 + x2*(-229139.77990731993 + x2*(3.150671973725649e6 + x2*(-2.590552511729978e7 + x2*(1.377702926692761e8 + x2*(-4.965786373134347e8 + x2*(1.245584748594532e9 + x2*(-2.1980907328138804e9 + x2*(2.718691169532957e9 + x2*(-2.306768265058266e9 + x2*(1.2787519730214303e9 + x2*(-4.1706987427775884e8 + 6.0684770066869676e7*x2)))))))))))))
  elif n == 29:
    return x*(9.390815568749542 + x2*(-1358.5379856124337 + x2*(58281.27958277341 + x2*(-1.165625591655468e6 + x2*(1.317804488343821e7 + x2*(-9.344431826438004e7 + x2*(4.420635056353363e8 + x2*(-1.4482842470338638e9 + x2*(3.354481895703434e9 + x2*(-5.531952599931979e9 + x2*(6.453944699920643e9 + x2*(-5.203971220489371e9 + x2*(2.758104746859367e9 + x2*(-8.64363310981568e8 + 1.2135149932499847e8*x2))))))))))))))
  elif n == 30:
    return -0.31828851519396134 + x2*(148.00415956519203 + x2*(-11396.320286519785 + x2*(345688.38202443346 + x2*(-5.4816300578160165e6 + x2*(5.225820655117936e7 + x2*(-3.2463431342399293e8 + x2*(1.3805876845613768e9 + x2*(-4.14176305368413e9 + x2*(8.906144082758686e9 + x2*(-1.3781086107005547e10 + x2*(1.5212887260980148e10 + x2*(-1.1685261229448519e10 + x2*(5.932517239566172e9 + x2*(-1.7891718659009087e9 + 2.4266928755897382e8*x2))))))))))))))
  else:
    raise ValueError("Order of the spherical harmonic is too high, n > 30")
